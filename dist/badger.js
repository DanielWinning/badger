(()=>{"use strict";var e={947:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentHandler=void 0;var a=r(774),o=r(698),n=function(){function e(e){this.commandOptions=[],this.flags=[],this.setupCommandOptions(),this.parseArguments(e)}return e.prototype.setupCommandOptions=function(){this.commandOptions.push(new a.CommandOption("json",!0,!0)),this.commandOptions.push(new a.CommandOption("jest",!1,!1))},e.prototype.parseArguments=function(e){var t=this;e.splice(0,2);for(var r=function(r){if(e[r].startsWith("--")){var n=e[r].slice(2),i=a.commandOptions.find((function(e){return e.getName()===n}));if(!i)throw new Error(o.Messages.ERROR_UNKNOWN_FLAG.replace("%s",n));if(i.requiresValue()){if(r+1<e.length&&!e[r+1].startsWith("--"))return a.addFlag(n,e[r+1],i),"continue";throw new Error(o.Messages.ERROR_MISSING_ARGUMENT_VALUE.replace("%s",n))}a.addFlag(n,null,i),a.commandOptions.forEach((function(e){if(e.isOptionRequired()&&!t.flags.find((function(t){return t.name===e.getName()})))throw new Error(o.Messages.ERROR_MISSING_REQUIRED_FLAG.replace("%s",e.getName()))}))}},a=this,n=0;n<e.length;n++)r(n)},e.prototype.addFlag=function(e,t,r){this.flags.push({name:e,value:t,commandOption:r})},e.prototype.getFlags=function(){return this.flags},e}();t.ArgumentHandler=n},520:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BadgeGenerator=void 0;var o=a(r(147)),n=function(){function e(e){this.flags=e;var t=this.flags.find((function(e){return"json"===e.name}));if(void 0===t)throw new Error("You must provide the --json flag with a path to the coverage JSON you wish to parse.");this.configPath=t.value,this.data=this.getJsonDataFromFilepath(this.configPath),this.run()}return e.prototype.getData=function(){return this.data},e.prototype.run=function(){if(this.flatFlags().includes("jest")){var e=this.getJestCoveragePercentagesForFiles(),t=this.getTotalJestCoverage(e),r=this.getCoverageStatus(t),a=this.generateHTMLBadge(t,r);this.updateReadmeWithBadge(a)}},e.prototype.flatFlags=function(){return this.flags.map((function(e){return e.name}))},e.prototype.getJestCoveragePercentagesForFiles=function(){var e=[];for(var t in this.data){var r=this.data[t];e.push(this.calculateCoverageFromJestData(r.s)),e.push(this.calculateCoverageFromJestData(r.f))}return e},e.prototype.getTotalJestCoverage=function(e){var t=e.length,r=e.reduce((function(e,t){return(Number(e)+Number(t)).toString()}));return(Number(r)/t).toFixed(2)},e.prototype.getCoverageStatus=function(e){var t=parseFloat(e);return t>=90?"green":t>=80?"yellow":"red"},e.prototype.generateHTMLBadge=function(e,t){var r=this.generateBadgeURL(e,t);return'<img src="'.concat(r,'" alt="Coverage ').concat(e,'%">')},e.prototype.generateBadgeURL=function(e,t){return"https://img.shields.io/badge/Coverage-".concat(e,"%25-").concat(t,".svg")},e.prototype.updateReadmeWithBadge=function(e){var t=this,r="./README.md";o.default.readFile(r,"utf8",(function(a,o){if(a)console.error("Error reading file ".concat(a));else{var n=/<!-- Coverage Badge -->\s*<img [^>]*>/;if(n.test(o)){var i=o.replace(n,"\x3c!-- Coverage Badge --\x3e\n".concat(e));t.updateReadmeFile(r,i)}else i=o.replace("\x3c!-- Coverage Badge --\x3e","\x3c!-- Coverage Badge --\x3e\n".concat(e)),t.updateReadmeFile(r,i)}}))},e.prototype.updateReadmeFile=function(e,t){o.default.writeFile(e,t,"utf8",(function(e){e?console.error("Error writing to README file: ".concat(e)):console.log("Badge added to README")}))},e.prototype.calculateCoverageFromJestData=function(e){var t=Object.keys(e).length;return(Object.values(e).filter((function(e){return e>0})).length/t*100).toFixed(2)},e.prototype.getJsonDataFromFilepath=function(e){try{return JSON.parse(o.default.readFileSync(e,"utf-8"))}catch(e){throw new Error("Error reading the config file.")}},e}();t.BadgeGenerator=n},774:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CommandOption=void 0;var r=function(){function e(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1),this.valueRequired=!1,this.isRequired=!1,this.name=e,this.isRequired=t,this.valueRequired=r}return e.prototype.getName=function(){return this.name},e.prototype.isOptionRequired=function(){return this.isRequired},e.prototype.requiresValue=function(){return this.valueRequired},e}();t.CommandOption=r},698:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Messages=void 0,function(e){e.ERROR_MISSING_REQUIRED_FLAG="Please provide the %s flag",e.ERROR_MISSING_ARGUMENT_VALUE="The %s flag requires a value",e.ERROR_UNKNOWN_FLAG="Unknown flag: --%s"}(r||(t.Messages=r={}))},147:e=>{e.exports=require("fs")}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}var a={};(()=>{var e=a;Object.defineProperty(e,"__esModule",{value:!0});var t=r(947),o=r(520),n=new t.ArgumentHandler(process.argv);new o.BadgeGenerator(n.getFlags())})(),module.exports=a})();